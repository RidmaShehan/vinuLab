{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/ridmashehan/vinulab%20web/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst url = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\nif (typeof window === \"undefined\" && (!url || !serviceKey) && process.env.NODE_ENV === \"development\") {\n  console.warn(\n    \"[vinulab] Supabase not configured. Using file fallback for content/consultations/analytics. Set NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY in .env.local to use the database.\"\n  );\n}\n\nexport const supabase =\n  url && serviceKey ? createClient(url, serviceKey, { auth: { persistSession: false } }) : null;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,wBAAwB;AAChD,MAAM,aAAa,QAAQ,GAAG,CAAC,yBAAyB;AAExD,IAAI,kDAAkB,eAAe,CAAC,CAAC,OAAO,CAAC,UAAU,KAAK,oDAAyB,eAAe;IACpG,QAAQ,IAAI,CACV;AAEJ;AAEO,MAAM,WACX,OAAO,aAAa,IAAA,gMAAY,EAAC,KAAK,YAAY;IAAE,MAAM;QAAE,gBAAgB;IAAM;AAAE,KAAK"}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///Users/ridmashehan/vinulab%20web/src/lib/consultations.ts"],"sourcesContent":["import path from \"path\";\nimport fs from \"fs\";\nimport { supabase } from \"./supabase\";\n\nexport interface ConsultationRequest {\n  id: string;\n  name: string;\n  email: string;\n  message: string;\n  timestamp: number;\n  gotIt: boolean;\n}\n\nconst consultationsPath = () => path.join(process.cwd(), \"src\", \"data\", \"consultations.json\");\n\nfunction getConsultationsFromFile(): ConsultationRequest[] {\n  try {\n    const raw = fs.readFileSync(consultationsPath(), \"utf-8\");\n    return JSON.parse(raw) as ConsultationRequest[];\n  } catch {\n    return [];\n  }\n}\n\nexport async function getConsultations(): Promise<ConsultationRequest[]> {\n  if (supabase) {\n    const { data, error } = await supabase\n      .from(\"consultations\")\n      .select(\"*\")\n      .order(\"timestamp\", { ascending: false });\n    if (!error && data) {\n      return data.map((r) => ({\n        id: r.id,\n        name: r.name,\n        email: r.email,\n        message: r.message,\n        timestamp: r.timestamp,\n        gotIt: r.got_it ?? false,\n      }));\n    }\n  }\n  return getConsultationsFromFile();\n}\n\nexport async function addConsultation(\n  data: Omit<ConsultationRequest, \"id\" | \"timestamp\" | \"gotIt\">\n): Promise<ConsultationRequest> {\n  const record: ConsultationRequest = {\n    id: `${Date.now()}-${Math.random().toString(36).slice(2, 9)}`,\n    ...data,\n    timestamp: Date.now(),\n    gotIt: false,\n  };\n  if (supabase) {\n    const { error } = await supabase.from(\"consultations\").insert({\n      id: record.id,\n      name: record.name,\n      email: record.email,\n      message: record.message,\n      timestamp: record.timestamp,\n      got_it: record.gotIt,\n    });\n    if (error) throw new Error(error.message);\n    return record;\n  }\n  const list = getConsultationsFromFile();\n  list.unshift(record);\n  fs.writeFileSync(consultationsPath(), JSON.stringify(list, null, 2), \"utf-8\");\n  return record;\n}\n\nexport async function updateConsultationGotIt(id: string, gotIt: boolean): Promise<ConsultationRequest | null> {\n  if (supabase) {\n    const { data, error } = await supabase\n      .from(\"consultations\")\n      .update({ got_it: gotIt })\n      .eq(\"id\", id)\n      .select()\n      .single();\n    if (!error && data) {\n      return {\n        id: data.id,\n        name: data.name,\n        email: data.email,\n        message: data.message,\n        timestamp: data.timestamp,\n        gotIt: data.got_it ?? false,\n      };\n    }\n    return null;\n  }\n  const list = getConsultationsFromFile();\n  const idx = list.findIndex((r) => r.id === id);\n  if (idx === -1) return null;\n  list[idx] = { ...list[idx], gotIt };\n  fs.writeFileSync(consultationsPath(), JSON.stringify(list, null, 2), \"utf-8\");\n  return list[idx];\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;AAWA,MAAM,oBAAoB,IAAM,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,OAAO,QAAQ;AAExE,SAAS;IACP,IAAI;QACF,MAAM,MAAM,wGAAE,CAAC,YAAY,CAAC,qBAAqB;QACjD,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO,EAAE;IACX;AACF;AAEO,eAAe;IACpB,IAAI,oIAAQ,EAAE;QACZ,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CACnC,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,KAAK,CAAC,aAAa;YAAE,WAAW;QAAM;QACzC,IAAI,CAAC,SAAS,MAAM;YAClB,OAAO,KAAK,GAAG,CAAC,CAAC,IAAM,CAAC;oBACtB,IAAI,EAAE,EAAE;oBACR,MAAM,EAAE,IAAI;oBACZ,OAAO,EAAE,KAAK;oBACd,SAAS,EAAE,OAAO;oBAClB,WAAW,EAAE,SAAS;oBACtB,OAAO,EAAE,MAAM,IAAI;gBACrB,CAAC;QACH;IACF;IACA,OAAO;AACT;AAEO,eAAe,gBACpB,IAA6D;IAE7D,MAAM,SAA8B;QAClC,IAAI,GAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,GAAG,IAAI;QAC7D,GAAG,IAAI;QACP,WAAW,KAAK,GAAG;QACnB,OAAO;IACT;IACA,IAAI,oIAAQ,EAAE;QACZ,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,iBAAiB,MAAM,CAAC;YAC5D,IAAI,OAAO,EAAE;YACb,MAAM,OAAO,IAAI;YACjB,OAAO,OAAO,KAAK;YACnB,SAAS,OAAO,OAAO;YACvB,WAAW,OAAO,SAAS;YAC3B,QAAQ,OAAO,KAAK;QACtB;QACA,IAAI,OAAO,MAAM,IAAI,MAAM,MAAM,OAAO;QACxC,OAAO;IACT;IACA,MAAM,OAAO;IACb,KAAK,OAAO,CAAC;IACb,wGAAE,CAAC,aAAa,CAAC,qBAAqB,KAAK,SAAS,CAAC,MAAM,MAAM,IAAI;IACrE,OAAO;AACT;AAEO,eAAe,wBAAwB,EAAU,EAAE,KAAc;IACtE,IAAI,oIAAQ,EAAE;QACZ,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CACnC,IAAI,CAAC,iBACL,MAAM,CAAC;YAAE,QAAQ;QAAM,GACvB,EAAE,CAAC,MAAM,IACT,MAAM,GACN,MAAM;QACT,IAAI,CAAC,SAAS,MAAM;YAClB,OAAO;gBACL,IAAI,KAAK,EAAE;gBACX,MAAM,KAAK,IAAI;gBACf,OAAO,KAAK,KAAK;gBACjB,SAAS,KAAK,OAAO;gBACrB,WAAW,KAAK,SAAS;gBACzB,OAAO,KAAK,MAAM,IAAI;YACxB;QACF;QACA,OAAO;IACT;IACA,MAAM,OAAO;IACb,MAAM,MAAM,KAAK,SAAS,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAC3C,IAAI,QAAQ,CAAC,GAAG,OAAO;IACvB,IAAI,CAAC,IAAI,GAAG;QAAE,GAAG,IAAI,CAAC,IAAI;QAAE;IAAM;IAClC,wGAAE,CAAC,aAAa,CAAC,qBAAqB,KAAK,SAAS,CAAC,MAAM,MAAM,IAAI;IACrE,OAAO,IAAI,CAAC,IAAI;AAClB"}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///Users/ridmashehan/vinulab%20web/src/app/api/consultations/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { addConsultation, getConsultations } from \"@/lib/consultations\";\n\nfunction isAdmin(request: NextRequest): boolean {\n  const password = request.headers.get(\"x-admin-password\");\n  const expected = process.env.ADMIN_PASSWORD || \"vinulab-admin\";\n  return password === expected;\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json().catch(() => ({}));\n    const { name = \"\", email = \"\", message = \"\" } = body;\n    const record = await addConsultation({\n      name: String(name).slice(0, 200),\n      email: String(email).slice(0, 256),\n      message: String(message).slice(0, 2000),\n    });\n    return NextResponse.json({ ok: true, id: record.id });\n  } catch (err) {\n    console.error(\"Consultation submit error:\", err);\n    return NextResponse.json({ error: \"Submit failed\" }, { status: 500 });\n  }\n}\n\nexport async function GET(request: NextRequest) {\n  if (!isAdmin(request)) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n  }\n  try {\n    const list = await getConsultations();\n    return NextResponse.json(list);\n  } catch (err) {\n    console.error(\"Consultations fetch error:\", err);\n    return NextResponse.json({ error: \"Fetch failed\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,SAAS,QAAQ,OAAoB;IACnC,MAAM,WAAW,QAAQ,OAAO,CAAC,GAAG,CAAC;IACrC,MAAM,WAAW,QAAQ,GAAG,CAAC,cAAc,IAAI;IAC/C,OAAO,aAAa;AACtB;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QACjD,MAAM,EAAE,OAAO,EAAE,EAAE,QAAQ,EAAE,EAAE,UAAU,EAAE,EAAE,GAAG;QAChD,MAAM,SAAS,MAAM,IAAA,gJAAe,EAAC;YACnC,MAAM,OAAO,MAAM,KAAK,CAAC,GAAG;YAC5B,OAAO,OAAO,OAAO,KAAK,CAAC,GAAG;YAC9B,SAAS,OAAO,SAAS,KAAK,CAAC,GAAG;QACpC;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,IAAI,OAAO,EAAE;QAAC;IACrD,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAgB,GAAG;YAAE,QAAQ;QAAI;IACrE;AACF;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI,CAAC,QAAQ,UAAU;QACrB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;IACA,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,iJAAgB;QACnC,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF"}}]
}